% This is a template for Ph.D. dissertations in the UCI format.

% All fonts, including those for sub- and superscripts, must be 10 points or larger.
% Recommended sizes are 14-point for chapter headings, 12-point for the main body of text
% and figure/table titles, and 10-point for footnotes, sub- and super-scripts, and text in
% figures and tables.
\documentclass[12pt,fleqn]{ucithesis}

\usepackage[T1]{fontenc}
\usepackage{adjustbox}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{array}
\usepackage{color}
\usepackage{bm}
\usepackage{boxedminipage}
\usepackage{array}
\usepackage{bm}
\usepackage{boxedminipage}
\usepackage{bold-extra}
\usepackage{graphicx}
\usepackage{path}
\usepackage{psfrag}
\usepackage{relsize}
\usepackage{subfigure}
\usepackage{textcomp}
\usepackage{caption}
\usepackage{enumitem}
\usepackage{fixltx2e}

\usepackage{python}   % have to pre-process the jsc bytecode dump
\usepackage{courier}  % need a bfseries ttfamily


\usepackage{url}
\usepackage{todonotes}
\usepackage{alltt}
\usepackage{upquote}
\usepackage{comment}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{multicol}

\newtheorem{theorem}{Theorem}
\newtheorem{definition}{Definition}

% etoolbox from python package, setspace from ucithesis.sty
\BeforeBeginEnvironment{equation}{\begin{singlespace}}
\AfterEndEnvironment{equation}{\end{singlespace}\noindent\ignorespaces}

\newcommand{\term}{\emph}
\newcommand{\code}{\texttt}

\newcommand{\FlowCore}[0]{\textsc{FlowCore}}
\newcommand{\JitFlow}[0]{\textsc{JitFlow}}

\newcommand{\FlowLabel}[0]{\code{FlowLabel}}
\newcommand{\FlowLabelObject}[0]{\code{FlowLabelObject}}
\newcommand{\FlowLabelRegistry}[0]{\code{FlowLabelRegistry}}

\newcommand{\JSValue}[0]{\code{JSValue}}
\newcommand{\Network}[0]{\code{Network}}
\newcommand{\UnaryExpression}[0]{\textit{UnaryExpression}}
\newcommand{\mjoin}[0]{\code{join}}
\newcommand{\msubsumes}[0]{\code{subsumes}}
\newcommand{\mlabelof}[0]{\code{labelof}}
\newcommand{\pclabel}[0]{\mbox{pc-label}}

\newcommand{\superscript}[1]{\ensuremath{^{\textrm{#1}}}}
\newcommand{\subscript}[1]{\ensuremath{_{\textrm{#1}}}}
\newcommand{\bracketdbl}[1]{\textlbrackdbl \code{#1}\textrbrackdbl}
\newcommand{\codestringdbl}[1]{\code{\textquotedbl #1\textquotedbl}}

\newcommand{\codeline}[1]{line~\code{#1}}
\newcommand{\Codeline}[1]{Line~\code{#1}}
\newcommand{\codelines}[2]{lines~\code{#1}--\code{#2}}
\newcommand{\bcodeline}[1]{offset~\code{#1}}

\newcommand{\jsvalue}[0]{\code{JSValue}}
\newcommand{\jsvalues}[0]{\code{JSValue}s}

\usepackage{tikz}
\usetikzlibrary{arrows}
\usetikzlibrary{backgrounds}
\usetikzlibrary{calc}
\usetikzlibrary{chains}
\usetikzlibrary{decorations.markings}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{decorations.pathreplacing}
\usetikzlibrary{fit}
\usetikzlibrary{matrix}
\usetikzlibrary{positioning}
\usetikzlibrary{shapes}
\usetikzlibrary{shapes.multipart}
\usetikzlibrary{shapes.symbols}
\usetikzlibrary{snakes}

\newcommand{\tikzmark}[1]{\tikz[overlay,remember picture] \coordinate (#1) at (0,0);}
%\newcommand{\tikzmark}[1]{\tikz[overlay,remember picture] \node (#1) {};}

\usepackage{listings}
\lstdefinelanguage{JavaScript}{
  keywords={typeof, new, true, false, catch, function, return, null, catch, switch, var, if, in, while, do, else, case, break, subsumes, join, labelof},
  keywordstyle=\color{black}\bfseries,
  ndkeywords={class, export, boolean, throw, implements, import, this},
  ndkeywordstyle=\color{black}\bfseries,
  identifierstyle=\color{black},
  sensitive=false,
  comment=[l]{//},
  morecomment=[l]{  >}
  morecomment=[s]{/*}{*/},
  commentstyle=\color{gray}\ttfamily,
  stringstyle=\color{black}\ttfamily,
  morestring=[b]',
  morestring=[b]",
}

\lstdefinelanguage{JSCBytecode}{
  otherkeywords={dup\_cflabel, join\_cflabel, popj\_cflabel},
  keywordstyle=\color{black}\bfseries,
  morecomment=[s][\color{gray}\ttfamily]{[\ }{]},
}

\lstnewenvironment{js-embed} {\lstset{
  caption=,
  label=,
  language=JavaScript,
  basicstyle=\small\ttfamily,
  tabsize=2,
  showspaces=false,
  showtabs=false,
  tabsize=2,
}}{}

\lstnewenvironment{snippet} {\lstset{
  caption=,
  label=,
  language=JavaScript,
  frame=tb,
  basicstyle=\small,
  aboveskip={1\baselineskip},
}}{}

\lstnewenvironment{exploit-example} {\lstset{
  basicstyle=\small\ttfamily,
  tabsize=2,
  showspaces=false,
  showtabs=false,
  tabsize=2,
  frame=tb,
  captionpos=b,
  aboveskip={1.5\baselineskip},
  float=h,
  escapeinside={(*}{*)},
}}{}

\lstnewenvironment{jscode} {\lstset{
  language=JavaScript,
  basicstyle=\small\ttfamily,
  tabsize=2,
  showspaces=false,
  showtabs=false,
  tabsize=2,
  frame=tb,
  numbers=left,
  stepnumber=1,
  numberstyle=\tiny,
  numbersep=2pt,
  captionpos=b,
  aboveskip={1.5\baselineskip},
  float=h,
}}{}

\lstnewenvironment{jscbytecode} {\lstset{
  language=JSCBytecode,
  basicstyle=\small\ttfamily,
  tabsize=2,
  showspaces=false,
  showtabs=false,
  frame=tb,
  captionpos=b,
  aboveskip={1.5\baselineskip},
  float=h,
  escapeinside=||,
}}{}

\lstnewenvironment{asmcode} {\lstset{
  keywords={MOV,AND,ADD,OR},
  basicstyle=\small\ttfamily,
  comment=[l]{//},
  commentstyle=\color{gray}\ttfamily,
  showspaces=false,
  showtabs=false,
  frame=tb,
  captionpos=b,
  aboveskip={1.5\baselineskip},
  float=h,
  numbers=left,
  stepnumber=1,
  numberstyle=\tiny,
  numbersep=2pt,
}}{}



% plainpages=false fixes the "duplicate ignored" error with page counters
% Set pdfborder to 0 0 0 to disable colored borders around PDF hyperlinks
\usepackage[numbers]{natbib}
%\usepackage{mycite}
\usepackage[plainpages=false,pdfborder={0 0 0}]{hyperref}
\renewcommand*{\appendixautorefname}{Appendix}
\renewcommand*{\chapterautorefname}{Chapter}
\renewcommand*{\sectionautorefname}{Section}
\renewcommand*{\subsectionautorefname}{Section}

% Uncomment the following line to enable Unicode support. This will allow you
% to enter non-ASCII characters (such as accented characters) directly without
% having to use LaTeX's awkward escape syntax (e.g., \'{e})
% NOTE: You may have to install the ucs.sty package for this to work. See:
% http://www.unruh.de/DniQ/latex/unicode/
% \usepackage[utf8x]{inputenc}

\begin{document}

\thesistitle
{
        From \FlowCore\ to \JitFlow:\\
        Improving the speed of Information Flow in JavaScript.
}

\degreename{Doctor of Philosophy}

% Use the wording given in the official list of degrees awarded by UCI:
% http://www.rgs.uci.edu/grad/academic/degrees_offered.htm
\degreefield{Information and Computer Science}

% Your name as it appears on official UCI records.
\authorname{Eric Hennigan}

% Use the full name of each committee member.
\committeechair{Professor Michael Franz}
\othercommitteemembers
{
	Professor Athina Markopoulou\\
	Professor Ian Harris
}

\degreeyear{2014}

\copyrightdeclaration
{
	{\copyright} {\Degreeyear} \Authorname
}

% If you have previously published parts of your manuscript, you must list the
% copyright holders; see Section 3.2 of the UCI Thesis and Dissertation Manual.
% Otherwise, this section may be omitted.
\prepublishedcopyrightdeclaration
{
  Portions of Chapter \autoref{ch:defense} \copyright\ 2013 Springer-Verlag\\ % first-class
  Portions of Chapter \autoref{ch:terminology} \copyright\ 2013 Springer-Verlag\\ % first-class labels
  Portions of Chapter \autoref{ch:first-class-labels} \copyright\ 2013 Springer-Verlag\\ % first-class labels
  All other materials \copyright\ \Degreeyear\ \Authorname
}

% The dedication page is optional.
%\dedications
%{
%	To my parents...
%}

\acknowledgments
{
  I would like to extend gratitude and thanks to Prof. Michael Franz for his trust and patience in offering guidance to the often mistaken ways of young learners.
  I appreciate his talents in recruiting intelligent students who became my coworkers and friends, providing a wonderful environment in which to advance my skills in programming and absorb insights about the data structures and algorithms used to model programs.
  Without his talents in obtaining funding from the U.S. Government (DARPA contract No. D11Pc20024, NSF Grants CNS-0905684 and CCF-1117162) and from collaborators, namely Google and Mozilla, this research would not have been possible.

  I would also like to extend thanks to Prof. Ian Harris and Athina Markopoulou who agreed to serve on my committee, and suffer my public speaking efforts.

  I am further indebted to my Postdoctoral counselors: Christian Wimmer, Stefan Brunthaler, and Per Larse, for arguments and discussion over implementation details, advice on writing and strategy, and insights on research directions. For moral support I must also express my gratitude to my fellow students and friends: Gregor Wagner, Michael Bebenita, Mason Chang, Andrei Homescu, Wei Zhang, Gulfem Yeniceri, Stephen Crane, and Codrut Stancu.

  Finally, my partner on this project, Christoph Kerschbaumer, receives special mention for his patience and understanding when dealing with my stubbornness.
  Without his support, I would not have finished my degree.

  Lastly, I would like to thank my parents, Susan and Leroy, and my siblings, Ryan, Kurt, and Jayne, for their steady encouragement.
}

\include{cv}

\thesisabstract
{
Today's web applications remain vulnerable to cross-site scripting attacks that enable data theft.
Information flow tracking in the JavaScript VM of a web engine can track data flows through the web application and prevent the communication of sensitive data to unintended recipients, thereby stopping data theft.
Existing solutions have focused on the incorporating information flow into the JS interpreter, rather than the just-in-time compiler, rendering the resulting performance non-competitive.

This thesis presents an implementation of information flow tracking that works with the just-in-time compiler, outperforming all previous interpreter-based information flow tracking engines by more than a factor of two.
The JIT-based engine (i) has the same coverage as previous implementations,
(ii) requires comparatively light implementation effort,
and (iii) introduces new optimizations to remain performant.
When evaluated against three industry standard benchmark suites, the tracking engine retains an average slowdown of 73\% over engines that do not support information flow, remaining will within the range that many users will find an acceptable price for obtaining substantially increased security against data theft.
}

\preliminarypages

\include{motivation}
\include{attack-model}
\include{defense-model}
\include{terminology}
\include{label-propagation}
\include{implementation}
\include{first-class-labels}
\include{evaluation}
\include{related-work}
%\chapter{Policies}
%  matrx of trade-offs, issues
%  outline chart
%  real-world frequency of occurance
%  - no-sensitive upgrade vs others
\include{conclusion}

% These commands fix an odd problem in which the bibliography line
% of the Table of Contents shows the wrong page number.
\clearpage
\phantomsection

%\bibliographystyle{abbrv}
\bibliographystyle{amsalpha}
\bibliography{strdefs,refs,procs}

\chapter*{Appendices}
\addcontentsline{toc}{chapter}{Appendices}
\appendix
\include{system-design}
\include{features}
\include{benchmarks}

%\todo[inline]{pull citations from acsac-tr, into features?}
%\todo[inline]{feedback the motivation and thirdpartycode sections of 2013.taco into thesis motivation (pick up more cites)}
%\todo[inline]{fix the spacing issue on dup join and popj definitions}
%\todo[inline]{check bitwise-or and bitwise-and}
%\todo[inline]{globally, control flow stack or control-flow stack?}
%\todo[inline]{patch up citations, look at thesis.blg for problems}
%\todo[inline]{remove, 'we', 'us', 'our'}
%\todo[inline]{change earlier lattice picture to mention flowlabel and flowlabelregistry}

\end{document}
